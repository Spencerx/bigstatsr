<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sparse regression path — COPY_biglasso_main • bigstatsr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sparse regression path — COPY_biglasso_main"><meta property="og:description" content="Fit solution paths for linear or logistic regression models penalized by
lasso (alpha = 1) or elastic-net (1e-4 &amp;lt; alpha &amp;lt; 1) over a grid of values
for the regularization parameter lambda."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bigstatsr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Manual</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://www.youtube.com/watch?v=UXKYqpAo6cs" class="external-link">Video presentation of package bigstatsr</a>
    </li>
    <li>
      <a href="https://privefl.github.io/bigsnpr/articles/exo.html" class="external-link">Exercise</a>
    </li>
    <li>
      <a href="../articles/penalized-regressions.html">Fitting penalized regressions</a>
    </li>
    <li>
      <a href="../articles/bigstatsr-and-bigmemory.html">Packages bigstatsr and bigmemory</a>
    </li>
    <li>
      <a href="../articles/operations-with-scaling.html">Operations with scaling</a>
    </li>
    <li>
      <a href="../articles/read-FBM-from-file.html">Read a FBM from a text file</a>
    </li>
    <li>
      <a href="../articles/big-apply.html">Showcasing big_apply()</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://privefl.github.io/about.html" class="external-link">
    <span class="fa fa-user"></span>
     
    About
  </a>
</li>
<li>
  <a href="https://github.com/privefl/bigstatsr" class="external-link">
    <span class="fa fa-github fa"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o fa"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sparse regression path</h1>
    <small class="dont-index">Source: <a href="https://github.com/privefl/bigstatsr/blob/HEAD/R/biglasso.R" class="external-link"><code>R/biglasso.R</code></a></small>
    <div class="hidden name"><code>COPY_biglasso_main.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit solution paths for linear or logistic regression models penalized by
lasso (alpha = 1) or elastic-net (1e-4 &lt; alpha &lt; 1) over a grid of values
for the regularization parameter lambda.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">COPY_biglasso_main</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">y.train</span>,</span>
<span>  <span class="va">ind.train</span>,</span>
<span>  <span class="va">ind.col</span>,</span>
<span>  <span class="va">covar.train</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span><span class="op">)</span>,</span>
<span>  alphas <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  ind.sets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  lambda.min.ratio <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="va">p</span><span class="op">)</span> <span class="fl">1e-04</span> <span class="kw">else</span> <span class="fl">0.001</span>,</span>
<span>  nlam.min <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n.abort <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  base.train <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pf.X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pf.covar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  dfmax <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  lambda.min <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="va">p</span><span class="op">)</span> <span class="fl">1e-04</span> <span class="kw">else</span> <span class="fl">0.001</span>,</span>
<span>  power_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  power_adaptive <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  return.all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>family</dt>
<dd><p>Either "gaussian" (linear) or "binomial" (logistic).</p></dd>


<dt>alphas</dt>
<dd><p>The elastic-net mixing parameter that controls the relative
contribution from the lasso (l1) and the ridge (l2) penalty. The penalty is
defined as $$ \alpha||\beta||_1 + (1-\alpha)/2||\beta||_2^2.$$
<code>alpha = 1</code> is the lasso penalty and <code>alpha</code> in between <code>0</code>
(<code>1e-4</code>) and <code>1</code> is the elastic-net penalty. Default is <code>1</code>. <strong>You can
pass multiple values, and only one will be used (optimized by grid-search).</strong></p></dd>


<dt>K</dt>
<dd><p>Number of sets used in the Cross-Model Selection and Averaging
(CMSA) procedure. Default is <code>10</code>.</p></dd>


<dt>ind.sets</dt>
<dd><p>Integer vectors of values between <code>1</code> and <code>K</code> specifying
which set each index of the training set is in. Default randomly assigns
these values but it can be useful to set this vector for reproducibility,
or if you want to refine the grid-search over <code>alphas</code> using the same sets.</p></dd>


<dt>nlambda</dt>
<dd><p>The number of lambda values. Default is <code>200</code>.</p></dd>


<dt>lambda.min.ratio</dt>
<dd><p>The smallest value for lambda, <strong>as a fraction of
lambda.max</strong>. Default is <code>.0001</code> if the number of observations is larger than
the number of variables and <code>.001</code> otherwise.</p></dd>


<dt>nlam.min</dt>
<dd><p>Minimum number of lambda values to investigate. Default is <code>50</code>.</p></dd>


<dt>n.abort</dt>
<dd><p>Number of lambda values for which prediction on the validation
set must decrease before stopping. Default is <code>10</code>.</p></dd>


<dt>base.train</dt>
<dd><p>Vector of base predictions. Model will be learned starting
from these predictions. This can be useful if you want to previously fit
a model with large-effect variables that you don't want to penalize.</p></dd>


<dt>pf.X</dt>
<dd><p>A multiplicative factor for the penalty applied to each coefficient.
If supplied, <code>pf.X</code> must be a numeric vector of the same length as <code>ind.col</code>.
Default is all <code>1</code>. The purpose of <code>pf.X</code> is to apply differential
penalization if some coefficients are thought to be more likely than others
to be in the model. Setting SOME to 0 allows to have unpenalized coefficients.</p></dd>


<dt>pf.covar</dt>
<dd><p>Same as <code>pf.X</code>, but for <code>covar.train</code>.
You might want to set some to 0 as variables with large effects can mask
small effects in penalized regression.</p></dd>


<dt>eps</dt>
<dd><p>Convergence threshold for inner coordinate descent.
The algorithm iterates until the maximum change in the objective after any
coefficient update is less than <code>eps</code> times the null deviance.
Default value is <code>1e-5</code>.</p></dd>


<dt>max.iter</dt>
<dd><p>Maximum number of iterations. Default is <code>1000</code>.</p></dd>


<dt>dfmax</dt>
<dd><p>Upper bound for the number of nonzero coefficients. Default is
<code>50e3</code> because, for large data sets, computational burden may be
heavy for models with a large number of nonzero coefficients.</p></dd>


<dt>lambda.min</dt>
<dd><p>This parameter has been renamed <code>lambda.min.ratio</code> and is
now deprecated.</p></dd>


<dt>power_scale</dt>
<dd><p>When using lasso (alpha = 1), penalization to apply that
is equivalent to scaling genotypes dividing by (standard deviation)^power_scale.
Default is 1 and corresponding to standard scaling. Using 0 would correspond
to using unscaled variables and using 0.5 is Pareto scaling. If you e.g. use
<code>power_scale = c(0, 0.5, 1)</code>, the best value in CMSA will be used
(just like with <code>alphas</code>).</p></dd>


<dt>power_adaptive</dt>
<dd><p>Multiplicative penalty factor to apply to variables
in the form of 1 / m_j^power_adaptive, where m_j is the marginal statistic
for variable j. Default is 0, which effectively disables this option.
If you e.g. use <code>power_adaptive = c(0, 0.5, 1.5)</code>, the best value in CMSA
will be used (just like with <code>alphas</code>).</p></dd>


<dt>return.all</dt>
<dd><p>Deprecated. Now always return all models.</p></dd>


<dt>warn</dt>
<dd><p>Whether to warn if some models may not have reached a minimum.
Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The objective function for linear regression (<code>family = "gaussian"</code>) is
$$\frac{1}{2n}\textrm{RSS} + \textrm{penalty},$$ for logistic regression
(<code>family = "binomial"</code>) it is $$-\frac{1}{n} loglike +
\textrm{penalty}.$$</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Florian Privé.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

